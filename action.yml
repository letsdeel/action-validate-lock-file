name: 'validate package-lock.json '
description: 'this action will bump version of npm based library/package. it will work against the aws codeartifact registry and not against the package.json'
inputs:
  registry:
    description: "the account id in which the CodeArtifact is located"
    required: true
    type: string
    default: 974360507615
outputs:
  random-number:
    description: "Random number"
    value: ${{ steps.random-number-generator.outputs.random-number }}
runs:
  using: "composite"
  steps:
    - run: echo "${{ github.action_path }}" >> $GITHUB_PATH
      shell: bash
    - run: |
        STATUS=$(jq -r '.packages[] | select(.resolved != null) | .resolved' package-lock.json | grep -v "https://npm-${{ inputs.registry }}.d.codeartifact.eu-west-1.amazonaws.com")
        if [ -z $STATUS ]; then
          echo "success"
        else
          echo "fail"
      shell: bash
